<!DOCTYPE html>
<html lang="en" dir="ltr">
   <head>
      <meta charset="utf-8">
      <title>Login</title>
      <link rel="stylesheet" href="login.css">
   </head>
   <body>
      <div class="wrapper">
         <div class="title">
            Login Form
         </div>
          
         <form id="login-form">
            <div class="field">
               <input type="text" id="email" required>
               <label>Email Address</label>
            </div>
            <div class="field">
               <input type="password" id="password" required>
               <label>Password</label>
            </div>
            <div class="content">
               <div class="checkbox">
                  <input type="checkbox" id="remember-me">
                  <label for="remember-me">Remember me</label>
               </div>
               <div class="pass-link">
                  <a href="#">Forgot password?</a>
               </div>
            </div>
            <div class="field">
               <input type="submit" value="Login">
            </div>
            <div class="signup-link">
               Not a member? <a href="/register">Signup now</a>
            </div>
         </form>
      </div>

      <script>
        document.getElementById("login-form").addEventListener("submit", async (e) => {
            e.preventDefault(); // Prevent default form submission
            
            const email = document.getElementById("email").value;
            const password = document.getElementById("password").value;
            console.log("EJS",email, password);
            try {
                // Make a POST request to the backend for login
                const response = await fetch("http://localhost:3000/login", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify({ email, password }) // Send credentials to the backend
                });

                // Handle the response from the server
                const data = await response.json();
                if (response.ok) {
                    alert(data.message); // "Login successful"
                    // Optionally, redirect to a dashboard or another page
                    window.location.href = "/home"; 
                } else {
                    alert(data.error); // "Invalid credentials"
                    // Redirect to signup page if the credentials are invalid
                    window.location.href = "/register";  // Redirect to the signup page
                }
            } catch (error) {
                console.error("Error:", error);
                alert("An error occurred. Please try again later.");
            }
        });
      </script>
   </body>
</html>